<ion-view title="Evénements">
  <ion-nav-buttons side="right">
    <button class="button button-clear button-icon ion-more" ng-click="vm.showPopover($event)"></button>
  </ion-nav-buttons>
  <ion-content>
    <ion-refresher pulling-text="Mettre à jour la liste..." on-refresh="vm.doRefresh()"></ion-refresher>

    <div class="list card" ng-show="vm.runningEvents.length > 0">
      <div class="item item-avatar event-item" ng-repeat="event in vm.runningEvents | orderBy:'name'" ui-sref="app.event.infos({eventId: event.uuid})">
        <img ng-src="{{event.logoUrl}}" ng-if="event.logoUrl">
        <span class="label pull-right" ng-class="vm.tagColor(event.tags[0])" ng-show="event.tags.length > 0">{{event.tags[0]}}</span>
        <h2>{{event.name}}</h2>
        <p class="multiline l2">{{event.description}}</p>
        <div class="row meta">
          <div class="col" ng-if="event.address.city"><i class="ion-ios-location-outline"></i> {{event.address.city}}</div>
          <div class="col" ng-if="event.start"><i class="ion-android-calendar"></i> {{event.start | datePeriod:event.end}}</div>
        </div>
      </div>
    </div>

    <div class="list">
      <div class="item item-avatar event-item" ng-repeat="event in vm.events | orderBy:'-start'" ui-sref="app.event.infos({eventId: event.uuid})" ng-show="vm.showPastEvents || vm.isNear(event)">
        <img ng-src="{{event.logoUrl}}" ng-if="event.logoUrl">
        <span class="label pull-right" ng-class="vm.tagColor(event.tags[0])" ng-show="event.tags.length > 0">{{event.tags[0]}}</span>
        <h2>{{event.name}}</h2>
        <p class="multiline l2">{{event.description}}</p>
        <div class="row meta">
          <div class="col" ng-if="event.address.city"><i class="ion-ios-location-outline"></i> {{event.address.city}}</div>
          <div class="col" ng-if="event.start"><i class="ion-android-calendar"></i> {{event.start | datePeriod:event.end}}</div>
        </div>
      </div>
    </div>
    
    <div class="padding">
      <button class="button button-block" ng-click="vm.togglePastEvents()">{{vm.showPastEvents ? 'Masquer' : 'Voir'}} les événements passés</button>
    </div>
  </ion-content>
</ion-view>
